name: CI

on:
    - pull_request
    - push

jobs:
    tests_74:
        name: Run tests on PHP 7.4
        runs-on: ubuntu-latest
        steps:
          - name: Checkout
            uses: actions/checkout@v2
          - name: Set up PHP
            uses: shivammathur/setup-php@v2
            with:
                php-version: "7.4"
                tools: composer:v2
          - name: Install dependencies
            run: |
                composer require php-coveralls/php-coveralls:^2.2 --dev --no-update
                composer update --no-progress --prefer-dist
          - name: PHP-CS-Fixer code style analysis
            run: make php-cs-fixer
          - name: Psalm static analysis
            run: make psalm
          - name: PHPUnit test suite
            run: make phpunit
